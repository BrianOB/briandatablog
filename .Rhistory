kable(col.names=c('Metro area','Percent of jobs in public sector')) %>%
kable_styling(bootstrap_options=c('striped','responsive'),full_width = F)
blogdown:::serve_site()
library(tidyverse)
library(readr)
geo_data <- read_csv('C:/Users/Brian/Desktop/aff_download/DEC_10_SF1_G001_with_ann.csv')
head(geo_data)
setwd('C:/Users/Brian/Documents/Projects/dognames')
list.files(pattern="*.csv")
list.files(pattern="2*.csv")
list.files(pattern="2.*\.csv")
list.files(pattern="2.*\\.csv")
data_files <- list.files(pattern="2.*\\.csv")
test <- read_csv('2017.csv)
test <- read_csv('2017.csv')
library(lubridate)
test <- map(data_files,read_csv)
glimpse(test)
test <- map_df(data_files,read_csv)
glimpse(test)
data_files <- list.files(pattern="2.*\\.csv")
dog_years <- map_df(data_files,read_csv)
dog_life <- read_csv('dogliclt.csv')
glimpse(dog_life)
glimpse(dog_years)
dog_life %>%
group_by(ExpirationDate) %>%
count()
dog_life %>%
filter(is.na(ExpirationDate))
dog_life %>%
filter(!is.na(ExpirationDate))
dog_life <- dog_life %>%
filter(!is.na(ExpirationDate))
dog_life <- dog_life %>%
select(-ExpirationDate)
dog_years %>%
group_by(LicenseType) %>%
count()
test <- 'Dog Senior Citizen or Disability Neutered Male'
test1 <- strsplit(test,' ')
test1[length(test1)]
length(test1)
View(test1)
test <- 'Dog Senior Citizen or Disability Neutered Male'
test1 <- unlist(strsplit(test,' '))
test1[length(test1)]
test1[-1]
test1[1]
test1[-2]
tail(test1,1)
dog_years_r <- dog_years %>%
mutate(gender= ifelse(tail(unlist(strsplit(LicenseType)),1) %in% c("Male","Female"),
tail(unlist(strsplit(LicenseType)),1),NA))
dog_years_r <- dog_years %>%
mutate(gender= ifelse(tail(unlist(strsplit(LicenseType,' ')),1) %in% c("Male","Female"),
tail(unlist(strsplit(LicenseType,' ')),1),NA))
dog_years_r %>%
group_by(LicenseType,gender) %>%
count()
dog_years_r <- dog_years %>%
mutate(gender= (tail(unlist(strsplit(LicenseType,' ')),1))
dog_years_r <- dog_years %>%
mutate(gender= tail(unlist(strsplit(LicenseType,' ')),1))
dog_years_r %>%
group_by(LicenseType,gender) %>%
count()
dog_years_r <- dog_years %>%
separate(LicenseType,c('gender'),sep=" [:alnum:]+$")
dog_years_r <- dog_years %>%
separate(LicenseType,c('gender'),sep=" [:alnum:]+?$")
test1 <- data.frame(test)
View(test1)
test1 <- data.frame(test)
test1 %>%
separate(test,c('gender'),sep=" [:alnum:]+?$")
test1 <- data.frame(test)
test1 %>%
separate(test,c('license type','gender'),sep=" [:alnum:]+?$")
test1 <- data.frame(test)
test1 %>%
separate(test,c('license type','gender'),sep=" ?=[:alnum:]+?$")
test1 <- data.frame(test)
test1 %>%
separate(test,c('license type','gender'),sep=" ?!=[:alnum:]+?$")
test1 <- data.frame(test)
test1 %>%
separate(test,c('license type','gender'),sep=" ?=[:alnum:]+?$")
test1 <- data.frame(test)
test1 %>%
separate(test,c('license type','gender'),sep=" (?=[:alnum:]+)?$")
test1 <- data.frame(test)
test1 %>%
separate(test,c('license type','gender'),sep=" (?=[:alnum:]+?$)")
dog_years_r <- dog_years %>%
separate(test,c('license_remainder','gender'),sep=" (?=[:alnum:]+?$)")
dog_years_r <- dog_years %>%
separate(LicenseType,c('license_remainder','gender'),sep=" (?=[:alnum:]+?$)")
dog_years_r %>%
group_by(LicenseType,gender) %>%
count()
dog_years_r <- dog_years %>%
separate(LicenseType,c('license_remainder','gender'),sep=" (?=[:alnum:]+?$)",remove=F)
dog_years_r %>%
group_by(LicenseType,gender) %>%
count()
# kind of ugly but gets the last word in LicenseType and, if it's Male or Female, keeps it
dog_years_r <- dog_years %>%
separate(LicenseType,c('license_remainder','gender'),sep=" (?=[:alnum:]+?$)",remove=F) %>%
mutate(gender = ifelse(gender %in% c("Male","Female"),gender,NA))
dog_years_r %>%
group_by(LicenseType,gender) %>%
count()
# kind of ugly but gets the last word in LicenseType and, if it's Male or Female, keeps it
dog_years_r <- dog_years %>%
separate(LicenseType,c('license_remainder','gender'),sep=" (?=[:alnum:]+?$)",remove=F) %>%
mutate(gender = ifelse(gender %in% c("Male","Female"),gender,NA),
license_remainder = substr(license_remainder,5,nchar(license_remainder)))
dog_years_r %>%
group_by(LicenseType, license_remainder, gender) %>%
count()
grep(' [:alnum:]+$',test, value=T)
grep(' [:alnum:]+',test, value=T)
grep(' [:alnum:]',test, value=T)
grep(' [:alnum:]',test)
grep('dog',test)
grep('Dog',test)
grep(' ',test)
grep('S',test)
grep('d',test)
grep('z',test)
grep('Dog',test)
grep('Senior',test)
zebra <- grep('Senior',test)
zebra
regexpr(' ',test)
endsWith(test,'Male')
endsWith(test,'male')
dog_years_r <- dog_years %>%
mutate(gender = ifelse(endsWith(LicenseType,'Male'),'Male',
ifelse(endswith(LicenseType,'Female','Female',NA))))
dog_years_r <- dog_years %>%
mutate(gender = ifelse(endsWith(LicenseType,'Male'),'Male',
ifelse(endsWith(LicenseType,'Female','Female',NA))))
dog_years_r <- dog_years %>%
mutate(gender = ifelse(endsWith(LicenseType,'Male'),'Male',
ifelse(endsWith(LicenseType,'Female'),'Female',NA)))
dog_years_r %>%
group_by(LicenseType, gender) %>%
count()
dog_years_r <- dog_years %>%
mutate(gender = ifelse(endsWith(LicenseType,'Male'),'Male',
ifelse(endsWith(LicenseType,'Female'),'Female',NA))) %>%
mutate(license_remainder = ifelse(is.na(gender),LicenseType,substr(LicenseType,1,nchar(LicenseType)-(nchar(gender)+1))))
dog_years_r %>%
group_by(LicenseType, license_remiander, gender) %>%
count()
dog_years_r %>%
group_by(LicenseType, license_remainder, gender) %>%
count()
dog_years_r <- dog_years %>%
mutate(gender = ifelse(endsWith(LicenseType,'Male'),'Male',
ifelse(endsWith(LicenseType,'Female'),'Female',NA))) %>%
mutate(license_remainder = ifelse(is.na(gender),substr(LicenseType,5,nchar(LicenseType)),substr(LicenseType,5,nchar(LicenseType)-(nchar(gender)+1))))
dog_years_r %>%
group_by(LicenseType, license_remainder, gender) %>%
count()
dog_years <- dog_years %>%
mutate(gender = ifelse(endsWith(LicenseType,'Male'),'Male',
ifelse(endsWith(LicenseType,'Female'),'Female',NA))) %>%
mutate(LicenseType = ifelse(is.na(gender),substr(LicenseType,5,nchar(LicenseType)),substr(LicenseType,5,nchar(LicenseType)-(nchar(gender)+1))))
dog_life %>%
group_by(LicenseType) %>%
count()
View(dog_life)
View(dog_life)
View(dog_years)
View(dog_life)
glimpse(dog_life)
as.numeric(substr('5/27/2009',-4,99))
test <- '5/27/2009'
as.numeric(substr(test,nchar(test)-4,4))
substr(test,nchar(test)-4,4)
nchar(test)
substr(test,nchar(test)-4,nchar(test))
substr(test,nchar(test)-3,nchar(test))
as.numeric(substr(test,nchar(test)-3,nchar(test)))
dog_years <- dog_years %>%
mutate(year = ExpYear)
dog_life <- dog_life %>%
mutate(year=as.numeric(substr(ValidDate,nchar(ValidDate)-3,nchar(ValidDate))))
dog_years %>%
filter(is.na(year))
dog_life %>%
filter(is.na(year))
data_files <- list.files(pattern="2.*\\.csv")
dog_years <- map_df(data_files,read_csv)
dog_life <- read_csv('dogliclt.csv')
dog_life <- dog_life %>%
filter(!is.na(ExpirationDate))
dog_life <- dog_life %>%
select(-ExpirationDate)
dog_years <- dog_years %>%
mutate(year = ExpYear)
dog_life <- dog_life %>%
mutate(year=as.numeric(substr(ValidDate,nchar(ValidDate)-3,nchar(ValidDate))))
dog_all <- rbind(dog_life, dog_years)
dog_all %>%
group_by(LicenseType) %>%
count()
dog_all <- dog_all %>%
mutate(gender = ifelse(endsWith(LicenseType,'Male'),'Male',
ifelse(endsWith(LicenseType,'Female'),'Female',NA))) %>%
mutate(LicenseType = ifelse(is.na(gender),substr(LicenseType,5,nchar(LicenseType)),substr(LicenseType,5,nchar(LicenseType)-(nchar(gender)+1))))
lanham <- Lanham
lahman <- Lahman
batting <- Lahman::Batting
glimpse(batting)
batting %>% group_by(playerID) %>% tally(G) %>% top_n(10)
batting %>% group_by(playerID) %>% tally(G) %>% top_n(10) %>% arrange(n)
batting %>% group_by(playderID) %>% top_n(1,G)
batting %>% group_by(playerID) %>% top_n(1,G)
dog_all %>%
group_by(DogName,year) %>%
summarise(dogs = n()) %>%
arrange(year, desc(dogs), DogName) %>%
top_n(1, dogs)
dog_all %>%
group_by(year) %>%
summarise(dogs = n(DogName)) %>%
arrange(year, desc(dogs), DogName) %>%
top_n(1, dogs)
dog_all %>%
group_by(year) %>%
summarise(dogs = count(DogName)) %>%
arrange(year, desc(dogs), DogName) %>%
top_n(1, dogs)
dog_all %>%
group_by(year) %>%
summarise(dogs = count(DogName)) %>%
top_n(1, dogs)
dog_all %>%
group_by(year, DogName) %>%
summarise(dogs = count(DogName)) %>%
top_n(1, dogs)
dog_all %>%
group_by(year, DogName) %>%
summarise(dogs = n()) %>%
top_n(1, dogs)
dog_all %>%
group_by(year) %>%
summarise(licenses=n())
dog_all %>%
filter(year<2007) %>%
group_by(LicenseType) %>%
count()
data_files <- list.files(pattern="2.*\\.csv")
dog_years <- map_df(data_files,read_csv)
dog_life <- read_csv('dogliclt.csv')
glimpse(dog_life)
glimpse(dog_years)
dog_life %>%
group_by(ExpirationDate) %>%
count()
dog_life <- dog_life %>%
filter(!is.na(ExpirationDate))
dog_life <- dog_life %>%
select(-ExpirationDate)
dog_years <- dog_years %>%
mutate(year = ExpYear)
dog_life <- dog_life %>%
mutate(year=as.numeric(substr(ValidDate,nchar(ValidDate)-3,nchar(ValidDate))))
dog_years <- dog_years %>%
mutate(gender = ifelse(endsWith(LicenseType,'Male'),'Male',
ifelse(endsWith(LicenseType,'Female'),'Female',NA))) %>%
mutate(LicenseType = ifelse(is.na(gender),substr(LicenseType,5,nchar(LicenseType)),substr(LicenseType,5,nchar(LicenseType)-(nchar(gender)+1))))
dog_life <- dog_life %>%
mutate(gender = ifelse(endsWith(LicenseType,'Male'),'Male',
ifelse(endsWith(LicenseType,'Female'),'Female',NA))) %>%
mutate(LicenseType = ifelse(is.na(gender),substr(LicenseType,5,nchar(LicenseType)),substr(LicenseType,5,nchar(LicenseType)-(nchar(gender)+1))))
dog_years %>%
group_by(year) %>%
summarise(licenses=n())
dog_years %>%
group_by(year, DogName) %>%
summarise(dogs = n()) %>%
top_n(1, dogs)
dog_years %>%
group_by(year, gender, DogName) %>%
summarise(dogs=n()) %>%
top_n(1,dogs)
dog_years %>%
group_by(year, gender, DogName) %>%
summarise(dogs=n()) %>%
top_n(1,dogs) %>%
spread(gender)
dog_years %>%
group_by(year, gender, DogName) %>%
summarise(dogs=n()) %>%
top_n(1,dogs) %>%
arrange(year,gender)
dog_years %>%
filter(!is.na(gender)) %>%
group_by(year, gender, DogName) %>%
summarise(dogs=n()) %>%
top_n(1,dogs) %>%
arrange(year,gender)
dog_years %>%
filter(!is.na(gender)) %>%
group_by(year, gender, DogName) %>%
summarise(dogs=n()) %>%
top_n(1,dogs) %>%
spread(gender,dogs)
top_dogs <- dog_years %>%
filter(!is.na(gender)) %>%
group_by(year, gender, DogName) %>%
summarise(dogs=n()) %>%
top_n(1,dogs)
top_males <- top_dogs %>%
filter(gender=='Male') %>%
spread(DogName, dogs)
View(top_males)
top_dogs <- dog_years %>%
filter(!is.na(gender)) %>%
group_by(year, gender, DogName) %>%
summarise(dogs=n()) %>%
top_n(3,dogs)
View(top_dogs)
# get the top 3 dog names by gender for each year
top_dogs <- dog_years %>%
filter(!is.na(gender)) %>%
group_by(year, gender, DogName) %>%
summarise(dogs=n()) %>%
top_n(3,dogs)
# get list of those names
top_male_names <- select(filter(top_dogs,gender=='Male'),DogName)
View(top_male_names)
top_male_names <- as.character(select(filter(top_dogs,gender=='Male'),DogName))
top_male_names <- top_dogs$DogName[which(top_dogs$gender=='Male')]
top_male_names <- unique(top_dogs$DogName[which(top_dogs$gender=='Male')])
top_female_names <- unique(top_dogs$DogName[which(top_dogs$gender=='Female')])
top_all_names <- unique(top_dogs$DogName)
dog_years %>%
filter(DogName %in% top_all_names) %>%
group_by(year, gender, DogName) %>%
summarise(dogs=n()) %>%
ggplot(aes(x=year, y=dogs, group=gender)) +
geom_line()
dog_years %>%
filter(DogName %in% top_all_names) %>%
group_by(year, gender, DogName) %>%
summarise(licenses=n()) %>%
ggplot(aes(x=year, y=licenses, group=1)) +
geom_line()
# get the top 3 dog names by gender for each year
top_dogs <- dog_years %>%
filter(!is.na(gender)) %>%
group_by(year, gender, DogName) %>%
summarise(dogs=n()) %>%
top_n(3,dogs)
# get list of those names
top_male_names <- unique(top_dogs$DogName[which(top_dogs$gender=='Male')])
top_female_names <- unique(top_dogs$DogName[which(top_dogs$gender=='Female')])
top_all_names <- unique(top_dogs$DogName)
# create graphs of male and female names by frequency over year for the top names
dog_years %>%
filter(DogName %in% top_all_names) %>%
group_by(year, gender) %>%
summarise(licenses=n()) %>%
ggplot(aes(x=year, y=licenses, group=gender)) +
geom_line()
# create graphs of male and female names by frequency over year for the top names
dog_years %>%
filter(DogName %in% top_all_names) %>%
group_by(year, gender) %>%
summarise(licenses=n()) %>%
ggplot(aes(x=year, y=licenses, group=DogName)) +
geom_line()
# create graphs of male and female names by frequency over year for the top names
dog_years %>%
filter(DogName %in% top_all_names) %>%
group_by(year, DogName) %>%
summarise(licenses=n()) %>%
ggplot(aes(x=year, y=licenses, group=DogName)) +
geom_line()
# create graphs of male and female names by frequency over year for the top names
dog_years %>%
filter(DogName %in% top_all_names) %>%
group_by(year, DogName) %>%
summarise(licenses=n()) %>%
ggplot(aes(x=year, y=licenses, group=DogName,color=DogName)) +
geom_line()
# create graphs of male and female names by frequency over year for the top names
dog_years %>%
filter(DogName %in% top_male_names) %>%
group_by(year, DogName) %>%
summarise(licenses=n()) %>%
ggplot(aes(x=year, y=licenses, group=DogName,color=DogName)) +
geom_line()
# create graphs of male and female names by frequency over year for the top names
dog_years %>%
filter(DogName %in% top_male_names) %>%
group_by(year, DogName) %>%
summarise(licenses=n()) %>%
ggplot(aes(x=year, y=licenses, group=DogName,color=DogName)) +
geom_line() +
scale_fill_brewer(palette='Set1')
# create graphs of male and female names by frequency over year for the top names
dog_years %>%
filter(DogName %in% top_male_names) %>%
group_by(year, DogName) %>%
summarise(licenses=n()) %>%
ggplot(aes(x=year, y=licenses, group=DogName,color=DogName)) +
geom_line() +
scale_colour_brewer(palette='Set1')
save(dog_years,'dog_licenses_annual.RData')
save(dog_years,file='dog_licenses_annual.RData')
blogdown:::serve_site()
library(tidyverse)
library(kableExtra)
load('C:/Users/Brian/Documents/Projects/dognames/dog_licenses_annual.RData')
licenses_per_year <- dog_years %>%
group_by(year) %>%
summarise(licenses = n())
top_dogs <- dog_years %>%
filter(!is.na(gender)) %>%
group_by(year, gender, DogName) %>%
summarise(dogs=n()) %>%
top_n(3,dogs)
# get list of those names
top_male_names <- unique(top_dogs$DogName[which(top_dogs$gender=='Male')])
top_female_names <- unique(top_dogs$DogName[which(top_dogs$gender=='Female')])
top_all_names <- unique(top_dogs$DogName)
top_males_year <- dog_years %>%
filter(DogName %in% top_male_names) %>%
group_by(year, DogName) %>%
summarise(licenses=n()) %>%
ggplot(aes(x=year, y=licenses, group=DogName,color=DogName)) +
geom_line() +
scale_colour_brewer(palette='Set1')
top_females_year <- dog_years %>%
filter(DogName %in% top_female_names) %>%
group_by(year, DogName) %>%
summarise(licenses=n()) %>%
ggplot(aes(x=year, y=licenses, group=DogName,color=DogName)) +
geom_line() +
scale_colour_brewer(palette='Set1')
licenses_by_gender_year <- dog_years %>%
group_by(year,gender) %>%
summarise(licenses=n())
top_males_table <- dog_years %>%
filter(DogName %in% top_male_names) %>%
group_by(year, DogName) %>%
summarise(licenses=n()) %>%
spread(year)
top_males_table <- dog_years %>%
filter(DogName %in% top_male_names) %>%
group_by(year, DogName) %>%
summarise(licenses=n()) %>%
spread(year, licenses)
View(top_males_table)
top_males_table <- dog_years %>%
filter(DogName %in% top_male_names) %>%
group_by(year, DogName) %>%
summarise(licenses=n()) %>%
spread(year, licenses) %>%
arrange(desc(`2017`))
glimpse(dog_years)
library(lubridate)
dog_years$license_date <- mdy(ValidDate)
dog_years$license_date <- mdy(dog_years$ValidDate)
View(dog_years)
dog_years %>%
mutate(license_date=parse_date_time(ValidDate,select_formats='ymd HM'))
dog_years %>%
mutate(license_date=parse_date_time(ValidDate,orders='ymd HM'))
dog_years %>%
mutate(license_date=parse_date_time(ValidDate,orders='mdY HM'))
setwd('C:/Users/Brian/Documents/Projects/dognames')
data_files <- list.files(pattern="2.*\\.csv")
dog_years <- map_df(data_files,read_csv)
dog_life <- read_csv('dogliclt.csv')
library(tidyverse)
library(readr)
library(lubridate)
setwd('C:/Users/Brian/Documents/Projects/dognames')
data_files <- list.files(pattern="2.*\\.csv")
dog_years <- map_df(data_files,read_csv)
dog_life <- read_csv('dogliclt.csv')
dog_life <- dog_life %>%
filter(!is.na(ExpirationDate))
dog_life <- dog_life %>%
select(-ExpirationDate)
dog_years <- dog_years %>%
mutate(year = ExpYear)
dog_life <- dog_life %>%
mutate(year=as.numeric(substr(ValidDate,nchar(ValidDate)-3,nchar(ValidDate))))
dog_years <- dog_years %>%
mutate(gender = ifelse(endsWith(LicenseType,'Male'),'Male',
ifelse(endsWith(LicenseType,'Female'),'Female',NA))) %>%
mutate(LicenseType = ifelse(is.na(gender),substr(LicenseType,5,nchar(LicenseType)),substr(LicenseType,5,nchar(LicenseType)-(nchar(gender)+1))))
dog_life <- dog_life %>%
mutate(gender = ifelse(endsWith(LicenseType,'Male'),'Male',
ifelse(endsWith(LicenseType,'Female'),'Female',NA))) %>%
mutate(LicenseType = ifelse(is.na(gender),substr(LicenseType,5,nchar(LicenseType)),substr(LicenseType,5,nchar(LicenseType)-(nchar(gender)+1))))
# convert the text date to date
dog_years %>%
mutate(ValidDate=parse_date_time(ValidDate,orders='mdY HM'))
# convert the text date to date
dog_years <- dog_years %>%
mutate(ValidDate=parse_date_time(ValidDate,orders='mdY HM'))
save(dog_years,file='dog_licenses_annual.RData')
