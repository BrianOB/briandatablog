ggplot(aes(x=year, y=licenses, group=DogName,color=DogName)) +
geom_line() +
scale_colour_brewer(palette='Set1') +
scale_x_continuous(limits=c(2007:2018)) +
labs(title="Top male dog names",
y='Number of licenses')
top_males_yar
top_males_year
library(tidyverse)
library(kableExtra)
library(lubridate)
load('C:/Users/Brian/Documents/Projects/dognames/dog_licenses_annual.RData')
licenses_per_year <- dog_years %>%
group_by(year) %>%
summarise(licenses = n())
licenses_by_gender_year <- dog_years %>%
group_by(year,gender) %>%
summarise(licenses=n())
# when do people typically license their dogs?
license_month <- dog_years %>%
group_by(month = month(ValidDate)) %>%
summarise(licenses = n()) %>%
mutate(month_pct = licenses/sum(licenses))
# get the top 3 dog names by gender for each year
top_dogs <- dog_years %>%
filter(!is.na(gender)) %>%
group_by(year, gender, DogName) %>%
summarise(dogs=n()) %>%
top_n(3,dogs)
# get list of those names
top_male_names <- unique(top_dogs$DogName[which(top_dogs$gender=='Male')])
top_female_names <- unique(top_dogs$DogName[which(top_dogs$gender=='Female')])
top_all_names <- unique(top_dogs$DogName)
# create graphs of top male and female dogs by number of licenses per year
top_males_year <- dog_years %>%
filter(DogName %in% top_male_names) %>%
group_by(year, DogName) %>%
summarise(licenses=n()) %>%
ggplot(aes(x=year, y=licenses, group=DogName,color=DogName)) +
geom_line() +
scale_colour_brewer(palette='Set1') +
scale_x_continuous(limits=c(2007:2018)) +
labs(title="Top male dog names",
y='Number of licenses')
top_females_year <- dog_years %>%
filter(DogName %in% top_female_names) %>%
group_by(year, DogName) %>%
summarise(licenses=n()) %>%
ggplot(aes(x=year, y=licenses, group=DogName,color=DogName)) +
geom_line() +
scale_colour_brewer(palette='Set1') +
scale_x_continuous(limits=c(2007:2018)) +
labs(title="Top female dog names",
y='Number of licenses')
# create tables of male and female names by count with most frequent in 2017 as
# sort variable
top_males_table <- dog_years %>%
filter(DogName %in% top_male_names) %>%
group_by(year, DogName) %>%
summarise(licenses=n()) %>%
spread(year, licenses) %>%
arrange(desc(`2017`))
top_females_table <- dog_years %>%
filter(DogName %in% top_female_names) %>%
group_by(year, DogName) %>%
summarise(licenses=n()) %>%
spread(year, licenses) %>%
arrange(desc(`2017`))
top_males_year
top_males_year <- dog_years %>%
filter(DogName %in% top_male_names) %>%
group_by(year, DogName) %>%
summarise(licenses=n()) %>%
ggplot(aes(x=year, y=licenses, group=DogName,color=DogName)) +
geom_line() +
scale_colour_brewer(palette='Set1') +
scale_x_continuous(limits=c(2007:2018))
top_males_year
top_males_year <- dog_years %>%
filter(DogName %in% top_male_names) %>%
group_by(year, DogName) %>%
summarise(licenses=n()) %>%
ggplot(aes(x=year, y=licenses, group=DogName,color=DogName)) +
geom_line()
top_males_year
top_males_year <- dog_years %>%
filter(DogName %in% top_male_names) %>%
group_by(year, DogName) %>%
summarise(licenses=n()) %>%
ggplot(aes(x=year, y=licenses, group=DogName,color=DogName)) +
geom_line() +
scale_colour_brewer(palette='Set1')
top_males_year
top_males_year <- dog_years %>%
filter(DogName %in% top_male_names) %>%
group_by(year, DogName) %>%
summarise(licenses=n()) %>%
ggplot(aes(x=year, y=licenses, group=DogName,color=DogName)) +
geom_line() +
scale_colour_brewer(palette='Set1') +
scale_x_continuous(limits=c(2007:2018))
top_males_year
top_males_year <- dog_years %>%
filter(DogName %in% top_male_names) %>%
group_by(year, DogName) %>%
summarise(licenses=n()) %>%
ggplot(aes(x=year, y=licenses, group=DogName,color=DogName)) +
geom_line() +
scale_colour_brewer(palette='Set1') +
scale_x_continuous(breaks=seq(2007,2018), limits=c(2007:2018)) +
labs(title="Top male dog names", y='Number of licenses')
top_males_year
top_males_year <- dog_years %>%
filter(DogName %in% top_male_names) %>%
rename(Year = year) %>%
group_by(Year, DogName) %>%
summarise(licenses=n()) %>%
ggplot(aes(x=Year, y=licenses, group=DogName,color=DogName)) +
geom_line() +
scale_colour_brewer(palette='Set1') +
scale_x_continuous(breaks=c(2007:2018))
top_males_year
top_males_year <- dog_years %>%
filter(DogName %in% top_male_names) %>%
group_by(year, DogName) %>%
summarise(licenses=n()) %>%
ggplot(aes(x=year, y=licenses, group=DogName,color=DogName)) +
geom_line() +
scale_colour_brewer(palette='Set1') +
scale_x_continuous(breaks=c(2007:2018)) +
labs(title="Top male dog names", y='Number of licenses')
top_males_year
top_females_year <- dog_years %>%
filter(DogName %in% top_female_names) %>%
group_by(year, DogName) %>%
summarise(licenses=n()) %>%
ggplot(aes(x=year, y=licenses, group=DogName,color=DogName)) +
geom_line() +
scale_colour_brewer(palette='Set1') +
scale_x_continuous(breaks=c(2007:2018)) +
labs(title="Top female dog names",
y='Number of licenses')
top_females_year
top_males_year <- dog_years %>%
filter(DogName %in% top_male_names) %>%
rename(Year = year) %>%
group_by(Year, DogName) %>%
summarise(licenses=n()) %>%
ggplot(aes(x=Year, y=licenses, group=DogName,color=DogName)) +
geom_line() +
scale_colour_brewer(palette='Set1') +
scale_x_continuous(breaks=c(2007:2018)) +
theme(text=element_text(family=windowsFont("TT Helvetica")),
title=element_text(size=24))
top_males_year
warnings()
windowsFonts(Helvetica = windowsFont("TT Helvetica"))
top_males_year <- dog_years %>%
filter(DogName %in% top_male_names) %>%
rename(Year = year) %>%
group_by(Year, DogName) %>%
summarise(licenses=n()) %>%
ggplot(aes(x=Year, y=licenses, group=DogName,color=DogName)) +
geom_line() +
scale_colour_brewer(palette='Set1') +
scale_x_continuous(breaks=c(2007:2018)) +
theme(text=element_text(family=Helvetica,
title=element_text(size=24))
top_males_year
top_males_year <- dog_years %>%
filter(DogName %in% top_male_names) %>%
rename(Year = year) %>%
group_by(Year, DogName) %>%
summarise(licenses=n()) %>%
ggplot(aes(x=Year, y=licenses, group=DogName,color=DogName)) +
geom_line() +
scale_colour_brewer(palette='Set1') +
scale_x_continuous(breaks=c(2007:2018)) +
theme(text=element_text(family=Helvetica),
title=element_text(size=24))
top_males_year <- dog_years %>%
filter(DogName %in% top_male_names) %>%
rename(Year = year) %>%
group_by(Year, DogName) %>%
summarise(licenses=n()) %>%
ggplot(aes(x=Year, y=licenses, group=DogName,color=DogName)) +
geom_line() +
scale_colour_brewer(palette='Set1') +
scale_x_continuous(breaks=c(2007:2018)) +
theme(text=element_text(family='Helvetica'),
title=element_text(size=24))
top_males_year
top_males_year <- dog_years %>%
filter(DogName %in% top_male_names) %>%
rename(Year = year) %>%
group_by(Year, DogName) %>%
summarise(licenses=n()) %>%
ggplot(aes(x=Year, y=licenses, group=DogName,color=DogName)) +
geom_line() +
scale_colour_brewer(palette='Set1') +
scale_x_continuous(breaks=c(2007:2018)) +
labs(title='Top male dog names',
y='Number of licenses',
x='Year') +
theme(text=element_text(family='Helvetica'),
plot.title=element_text(size=24))
top_males_year
top_males_year
top_males_year <- dog_years %>%
filter(DogName %in% top_male_names) %>%
rename(Year = year) %>%
group_by(Year, DogName) %>%
summarise(licenses=n()) %>%
ggplot(aes(x=Year, y=licenses, group=DogName,color=DogName)) +
geom_line() +
scale_colour_brewer(palette='Set1') +
scale_x_continuous(breaks=c(2007:2018)) +
labs(title='Top male dog names',
y='Number of licenses',
x='Year') +
theme(text=element_text(family='Helvetica'),
plot.title=element_text(size=24, hjust=0.5),
legend.title='Name')
top_males_year <- dog_years %>%
filter(DogName %in% top_male_names) %>%
rename(Year = year) %>%
group_by(Year, DogName) %>%
summarise(licenses=n()) %>%
ggplot(aes(x=Year, y=licenses, group=DogName,color=DogName)) +
geom_line() +
scale_colour_brewer(palette='Set1') +
scale_x_continuous(breaks=c(2007:2018)) +
labs(title='Top male dog names',
y='Number of licenses',
x='Year',
color='Name') +
theme(text=element_text(family='Helvetica'),
plot.title=element_text(size=24, hjust=0.5))
top_males_year
dog_years %>%
group_by(year) %>%
summarise(diff_names = n_distinct(DogName))
licenses_per_year <- dog_years %>%
group_by(year) %>%
summarise(licenses = n(),
unique_names = n_distinct(DogName))
View(licenses_per_year)
top_males_year <- dog_years %>%
filter(DogName %in% top_male_names) %>%
group_by(year, DogName) %>%
summarise(licenses=n()) %>%
ggplot(aes(x=year, y=licenses, group=DogName,color=DogName)) +
geom_line() +
scale_colour_brewer(palette='Set1') +
scale_x_continuous(breaks=c(2007:2018)) +
labs(title='Top male dog names',
y='Number of licenses',
x='Year',
color='Name') +
theme(text=element_text(family='Helvetica'),
plot.title=element_text(size=24, hjust=0.5))
top_females_year <- dog_years %>%
filter(DogName %in% top_female_names) %>%
group_by(year, DogName) %>%
summarise(licenses=n()) %>%
ggplot(aes(x=year, y=licenses, group=DogName,color=DogName)) +
geom_line() +
scale_colour_brewer(palette='Set1') +
scale_x_continuous(breaks=c(2007:2018)) +
labs(title='Top female dog names',
y='Number of licenses',
x='Year',
color='Name') +
theme(text=element_text(family='Helvetica'),
plot.title=element_text(size=24, hjust=0.5))
top_males_year
top_males_year
top_females_year
licenses_per_year %>%
kable()
licenses_per_year %>%
kable(col.names=c("Year","Number of licenses","Number of unique names"))
licenses_per_year %>%
kable(col.names=c("Year","Number of licenses","Number of unique names")) %>%
kable_styling(bootstrap_options=c('striped','responsive'),full_width = F)
license_month %>%
kable()
library(formattable)
licenses_per_year %>%
mutate(licenses = formattable::comma(licenses),
unique_names = formattable::comma(unique_names)) %>%
kable(col.names=c("Year","Number of licenses","Number of unique names")) %>%
kable_styling(bootstrap_options=c('striped','responsive'),full_width = F)
licenses_per_year %>%
mutate(licenses = formattable::comma(licenses,digits=0),
unique_names = formattable::comma(unique_names,digits=0)) %>%
kable(col.names=c("Year","Number of licenses","Number of unique names")) %>%
kable_styling(bootstrap_options=c('striped','responsive'),full_width = F)
month.name(1)
month.name[1]
dog_years$DogName[which(nchar(dog_years$DogName)==max(nchar(dog_years$DogName)))]
dog_years %>%
filter(nchar(DogName)==max(nchar(DogName)), DogName != 'NO DOG NAME PROVIDED ON APPLICATION')
dog_years %>%
filter(DogName != 'NO DOG NAME PROVIDED ON APPLICATION')
filter(nchar(DogName)==max(nchar(DogName)))
dog_years %>%
filter(DogName != 'NO DOG NAME PROVIDED ON APPLICATION') %>%
filter(nchar(DogName)==max(nchar(DogName)))
license_month %>%
mutate(month=month.name[month],
licenses=formattable::comma(licenses,digits=0),
month_pct=formattable::percent(month_pct,digits=1))
kable()
license_month %>%
mutate(ifelse(month<13,month=month.name[month],"NA"),
licenses=formattable::comma(licenses,digits=0),
month_pct=formattable::percent(month_pct,digits=1))
license_month %>%
mutate(month=ifelse(month<13,month=month.name[month],"NA"),
licenses=formattable::comma(licenses,digits=0),
month_pct=formattable::percent(month_pct,digits=1))
license_month %>%
mutate(month=ifelse(month<13,month.name[month],"NA"),
licenses=formattable::comma(licenses,digits=0),
month_pct=formattable::percent(month_pct,digits=1))
kable()
license_month %>%
mutate(month=ifelse(month<13,month.name[month],"NA"),
licenses=formattable::comma(licenses,digits=0),
month_pct=formattable::percent(month_pct,digits=1)) %>%
kable()
license_month %>%
mutate(month=ifelse(month<13,month.name[month],"NA"),
licenses=formattable::comma(licenses,digits=0),
month_pct=formattable::percent(month_pct,digits=1)) %>%
kable(col.names=c("Month",'Licenses','Percent of total')) %>%
kable_styling(bootstrap_options=c('striped','responsive'),full_width = F)
dog_years %>%
filter(DogName == 'NO DOG NAME PROVIDED ON APPLICATION')
dog_years$DogName[which(dog_years$DogName=='NO DOG NAME PROVIDED ON APPLICATION')]
dog_years$DogName[which(dog_years$DogName=='NO DOG NAME PROVIDED ON APPLICATION')] <- NA
longest_names <- dog_years %>%
filter(nchar(DogName)==max(nchar(DogName)))
longest_names <- dog_years %>%
filter(nchar(DogName)==max(nchar(DogName),na.rm=T))
shortest_names <- dog_years %>%
filter(nchar(DogName) == min(nchar(DogName),na.rm=T))
View(shortest_names)
View(longest_names)
longest_names <- unique(longest_names$DogName)
longest_names
licenses_per_year <- dog_years %>%
group_by(year) %>%
summarise(licenses = n(),
unique_names = n_distinct(DogName))
View(licenses_per_year)
load('C:/Users/Brian/Documents/Projects/dognames/dog_licenses_annual.RData')
dog_years %>%
filter(DogName==contains("NAME"))
library(stringr)
dog_years %>%
filter(strdetect(DogName,'NAME'))
dog_years %>%
filter(str_detect(DogName,'NAME'))
unnamed <- dog_years %>%
filter(str_detect(DogName,'NAME'))
View(unnamed)
dog_years %>%
filter(str_detect(DogName,'NAME')) %>%
group_by(DogName) %>%
count()
dog_years %>%
filter(str_detect(DogName,' NAME')) %>%
group_by(DogName) %>%
count()
unnamed <- dog_years %>%
filter(str_detect(DogName,' NAME')) %>%
group_by(DogName) %>%
count()
dog_years_r <- dog_years %>%
mutate(DogName2 = case_when(
str_detect(DogName,' NAME')~NA,
str_detect(DogName,'NAME ')~NA,
TRUE~DogName
))
str_detect("ALPHA","NAME")
str_detect("ALPHA","A")
dog_years_r <- dog_years
dog_years_r <- dog_years_r %>%
filter(str_detect(DogName," NAME")) %>%
mutate(DogName=NA)
dog_years_r <- dog_years
dog_years_r <- dog_years_r %>%
mutate(DogName = ifelse(str_detect(DogName," NAME"),NA,DogName))
dog_years %>%
filter(is.na(DogName))
dog_years_r %>%
filter(is.na(DogName))
dog_years_r %>%
filter(str_detect(DogName,"NAME ")) %>%
group_by(DogName) %>%
count()
dog_years_r <- dog_years_r %>%
mutate(DogName = ifelse(str_detect(DogName," NAME"),NA,DogName)) %>%
mutate(DogName = ifelse(str_detect(DogName,"NAME "),NA,DogName))
dog_years_r <- dog_years
dog_years_r <- dog_years_r %>%
mutate(DogName = ifelse(str_detect(DogName," NAME"),NA,DogName)) %>%
mutate(DogName = ifelse(str_detect(DogName,"NAME "),NA,DogName))
dog_years_r %>%
group_by(named = ifelse(is.na(DogName),"N","Y")) %>%
count()
dog_years <- dog_years %>%
mutate(DogName = ifelse(str_detect(DogName," NAME"),NA,DogName)) %>%
mutate(DogName = ifelse(str_detect(DogName,"NAME "),NA,DogName))
licenses_per_year <- dog_years %>%
group_by(year) %>%
summarise(licenses = n(),
unique_names = n_distinct(DogName))
View(licenses_per_year)
library(tidyverse)
library(kableExtra)
library(lubridate)
library(formattable)
library(stringr)
load('C:/Users/Brian/Documents/Projects/dognames/dog_licenses_annual.RData')
# In some cases, no name was given and the county isn't consistent about how it
# codes this
dog_years <- dog_years %>%
mutate(DogName = ifelse(str_detect(DogName," NAME"),NA,DogName)) %>%
mutate(DogName = ifelse(str_detect(DogName,"NAME "),NA,DogName))
licenses_per_year <- dog_years %>%
group_by(year) %>%
summarise(licenses = n(),
unique_names = n_distinct(DogName))
licenses_by_gender_year <- dog_years %>%
group_by(year,gender) %>%
summarise(licenses=n())
# when do people typically license their dogs?
license_month <- dog_years %>%
group_by(month = month(ValidDate)) %>%
summarise(licenses = n()) %>%
mutate(month_pct = licenses/sum(licenses))
# get the top 3 dog names by gender for each year
top_dogs <- dog_years %>%
filter(!is.na(gender)) %>%
group_by(year, gender, DogName) %>%
summarise(dogs=n()) %>%
top_n(3,dogs)
# get list of those names
top_male_names <- unique(top_dogs$DogName[which(top_dogs$gender=='Male')])
top_female_names <- unique(top_dogs$DogName[which(top_dogs$gender=='Female')])
top_all_names <- unique(top_dogs$DogName)
# create graphs of top male and female dogs by number of licenses per year
top_males_year <- dog_years %>%
filter(DogName %in% top_male_names) %>%
group_by(year, DogName) %>%
summarise(licenses=n()) %>%
ggplot(aes(x=year, y=licenses, group=DogName,color=DogName)) +
geom_line() +
scale_colour_brewer(palette='Set1') +
scale_x_continuous(breaks=c(2007:2018)) +
labs(title='Top male dog names',
y='Number of licenses',
x='Year',
color='Name') +
theme(text=element_text(family='Helvetica'),
plot.title=element_text(size=24, hjust=0.5))
top_females_year <- dog_years %>%
filter(DogName %in% top_female_names) %>%
group_by(year, DogName) %>%
summarise(licenses=n()) %>%
ggplot(aes(x=year, y=licenses, group=DogName,color=DogName)) +
geom_line() +
scale_colour_brewer(palette='Set1') +
scale_x_continuous(breaks=c(2007:2018)) +
labs(title='Top female dog names',
y='Number of licenses',
x='Year',
color='Name') +
theme(text=element_text(family='Helvetica'),
plot.title=element_text(size=24, hjust=0.5))
# create tables of male and female names by count with most frequent in 2017 as
# sort variable
top_males_table <- dog_years %>%
filter(DogName %in% top_male_names) %>%
group_by(year, DogName) %>%
summarise(licenses=n()) %>%
spread(year, licenses) %>%
arrange(desc(`2017`))
top_females_table <- dog_years %>%
filter(DogName %in% top_female_names) %>%
group_by(year, DogName) %>%
summarise(licenses=n()) %>%
spread(year, licenses) %>%
arrange(desc(`2017`))
top_females_year
top_males_year
licenses_per_year %>%
mutate(licenses = formattable::comma(licenses,digits=0),
unique_names = formattable::comma(unique_names,digits=0)) %>%
kable(col.names=c("Year","Number of licenses","Number of unique names")) %>%
kable_styling(bootstrap_options=c('striped','responsive'),full_width = F)
license_month %>%
mutate(month=ifelse(month<13,month.name[month],"NA"),
licenses=formattable::comma(licenses,digits=0),
month_pct=formattable::percent(month_pct,digits=1)) %>%
kable(col.names=c("Month",'Licenses','Percent of total')) %>%
kable_styling(bootstrap_options=c('striped','responsive'),full_width = F)
blogdown:::serve_site()
warnings()
